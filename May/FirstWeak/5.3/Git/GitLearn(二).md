[TOC]

# `Git`学习-- 廖雪峰网站

## 时光穿梭机

`git status` 命令是查看仓库当前的状态  

*没有被添加过的文件状态是 Untracked*

`git diff` 命令是查看修改了什么内容。

### 版本回退
#### 1. 查看历史

`git log` 命令可以查看提交历史记录。  
`git log` 命令显示从最近到最远的提交日志。  
如果嫌输出信息太多，可以加上 `--pretty=oneline` 参数：  
`git log --pretty==online` 
**提示：**大串类似`3628164...882e1e0`的是`commit id`(版本号)

#### 2. 版本回退

要实现版本回退，首先要知道当前版本是哪个版本，在`Git`中用`HEAD`表示当前版本。  
上一个版本用`HEAD^`表示，上上个版本用`HEAD^^`表示，上100个版本用`HEAD~100`表示。  
最后，使用 `git reset` 命令： 
例如:  
`git reset --hard HEAD^`

退回到了前面的版本后，想要再次回到之前的版本，必须是此时的命令窗口没有被关闭，然后通过下面的方式：

`git reset --hard 3628164` ：后面的那些数字就是版本号的前面一部分，不用把版本号写全。  

但是如果修改完后，关闭了命令窗口，想要再再恢复到之前的一个版本，还是要找到对应版本的版本号(`commit id`).  
`Git`提供了一个 `git reflog` 命令，用来记录每一次命令(即，命令历史记录)，再这些记录中，可以找到之前版本的版本号(最前面的那一段).

`cat 文件名` ：该命令是查看文件的内容。  

### 工作区和暂存区

1. 工作区(`Working Directory`)

在电脑中能看到的目录，以之前的例子为例，`learngit`文件夹就是工作区。  

2. 版本库(`Repository`)

工作区有个隐藏目录 `.git`，这不算工作区，而是 `Git` 版本库。  
版本库里有许多东西，其中最重要的是 `stage` (或者叫`index`) 的暂存区，  
还有一个`Git`自动创建的`master`分支，以及指向`master`的一个指针叫`HEAD`.

![工作区和暂存区](https://raw.githubusercontent.com/Onstar/Images/master/Git/工作区和暂存区.png)

之前把文件添加到`Git`版本库里时，是分两步走的：
```
//第一步，实际上就是把文件修改添加到暂存区
git add <file>
//第二部，提交更改，就是把暂存区的所有内容提交到当前分支上。
git commit -m "xxx"
```

### 管理修改

`Git`比其他版本控制系统设计的优秀，在于`Git`跟踪并管理的是修改，而非文件。  

`git diff HEAD -- <file>` 该命令是查看工作区和版本库里面最新版本的区别。  
如：`git diff HEAD -- readme.txt`  

### 撤销修改

`git checkout -- <file>` 命令，表示丢弃工作区的修改。  
如：   
`git checkout -- readme.txt` ，表示把`readme.txt`文件在工作区的修改全部撤销，这里有两种情况：  
一种是`readme.txt`文件修改后没有被放到暂存区，现在撤销修改就回到和版本库一样的状态；  
一种是`readme.txt`文件修改后添加到了暂存区，又作了修改，现在撤销就回到添加到暂存区的状态。  

总之，就是让文件回到最近一次`git commit`或`git add`时的状态。  

*命令中的 -- 很重要，如果没有 -- 就表示切换分支的命令*

2. 撤销修改第二种命令`git reset HEAD <file>`

这个命令可以把暂存区的修改撤销掉(`unstage`),重新放回工作区： 

![撤销修改的照片](https://raw.githubusercontent.com/Onstar/Images/master/Git/撤销修改.png)

`git reset`命令既可以回退版本，也可以把暂存区的修改退回到工作区。当用`HEAD`时，表示最新的版本。  

如果改错的东西从暂存区提交到了版本库(即,git commit)后，回退版本就可以了。(如果把本地版本推送到了远程，就没办法了)

### 删除文件

```
//假设有个 test.txt 文件
//在文件管理器中删除文件，用`rm`命令
rm test.txt
//执行该命令后，工作区内，改文件被删除了  
//Git知道你删除了改文件，因此，工作区和版本库就不一致了。  
//git status 命令可以知道哪些文件被删除了。  

//现在有两个选择：一： 确定要从版本库中删除改文件。两个步骤：
git rm test.txt
git commit -m "remove test.txt"

//二、删错了，返回删除前的状态
git checkout -- test.txt
```
*当确认删除后，最后还是发现删错了，可以使用版本回退的方法，回到之前的一个版本*  
